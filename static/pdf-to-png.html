<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF a PNG - PDF-Export & Import</title>
    <link rel="icon" type="image/x-icon" href="/static/fav.ico">
    <link rel="stylesheet" href="/static/css/styles.css">
    <style>
        /* Estilos especificos para PDF a PNG */
        .png-container {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 25px;
            margin-top: 20px;
        }

        .options-panel {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            height: fit-content;
        }

        .option-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--color-border);
        }

        .option-section:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .option-section h4 {
            margin-bottom: 12px;
            font-weight: 500;
        }

        /* Selector de modo */
        .mode-selector {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .mode-option {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .mode-option input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-top: 3px;
            accent-color: var(--color-primary);
        }

        .mode-option label {
            flex: 1;
            cursor: pointer;
        }

        .mode-option label strong {
            display: block;
            margin-bottom: 2px;
        }

        .mode-option label span {
            font-size: 0.85rem;
            color: var(--color-text-light);
        }

        /* Selector de DPI */
        .dpi-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .dpi-option {
            flex: 1;
            min-width: 70px;
        }

        .dpi-option input[type="radio"] {
            display: none;
        }

        .dpi-option label {
            display: block;
            padding: 12px 10px;
            background: var(--color-background);
            border: 2px solid var(--color-border);
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .dpi-option label span {
            display: block;
            font-size: 0.75rem;
            color: var(--color-text-light);
            margin-top: 4px;
        }

        .dpi-option input[type="radio"]:checked + label {
            border-color: var(--color-primary);
            background: var(--color-primary-light);
            color: var(--color-primary);
        }

        .dpi-option label:hover {
            border-color: var(--color-primary);
        }

        /* Selector de paginas */
        .pages-selector {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .page-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .page-option input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--color-primary);
        }

        .page-option label {
            flex: 1;
        }

        .page-range-inputs {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 28px;
            margin-top: 5px;
        }

        .page-range-inputs input[type="number"] {
            width: 70px;
            padding: 8px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            text-align: center;
        }

        .page-specific-input {
            margin-left: 28px;
            margin-top: 5px;
        }

        .page-specific-input input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
        }

        .page-specific-input small {
            display: block;
            color: var(--color-text-light);
            font-size: 0.75rem;
            margin-top: 4px;
        }

        /* Estimacion de tamano */
        .size-estimate {
            background: var(--color-background);
            border-radius: var(--radius-md);
            padding: 15px;
            margin-top: 15px;
        }

        .size-estimate-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--color-border);
        }

        .size-estimate-row:last-child {
            border-bottom: none;
        }

        .size-estimate-label {
            color: var(--color-text-light);
        }

        .size-estimate-value {
            font-weight: 600;
            color: var(--color-primary);
        }

        /* Preview */
        .preview-section {
            margin-top: 20px;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .preview-container {
            background: var(--color-background);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: 15px;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-thumbnail {
            max-width: 100%;
            max-height: 400px;
            box-shadow: var(--shadow-md);
        }

        .preview-placeholder {
            color: var(--color-text-light);
            font-style: italic;
            text-align: center;
        }

        /* Info del archivo */
        .file-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--color-background);
            padding: 12px 20px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
        }

        .file-info-name {
            font-weight: 500;
        }

        .file-info-pages {
            color: var(--color-primary);
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .png-container {
                grid-template-columns: 1fr;
            }

            .dpi-selector {
                flex-wrap: wrap;
            }

            .dpi-option {
                min-width: 45%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="logo" style="font-size: 2rem;"><a href="/" style="color: inherit; text-decoration: none;">PDF-Export &amp; Import</a></h1>
            <p class="subtitle">Convertir PDF a imagenes PNG</p>
        </header>

        <main class="main-content">
            <div class="png-container">
                <!-- Panel principal -->
                <section class="main-panel">
                    <!-- Zona de carga -->
                    <div id="zona-carga" class="upload-zone">
                        <div class="upload-icon">PNG</div>
                        <p class="upload-text">Arrastra un archivo PDF aqui</p>
                        <p class="upload-hint">o haz clic para seleccionar (maximo 1GB)</p>
                    </div>

                    <!-- Progreso de carga -->
                    <div id="progreso-carga" class="progress-large" style="display: none;">
                        <div class="progress-bar-large">
                            <div class="progress-fill" id="barra-progreso"></div>
                        </div>
                        <div class="progress-info">
                            <span id="texto-progreso">Subiendo...</span>
                            <span id="porcentaje-progreso">0%</span>
                        </div>
                    </div>

                    <!-- Info del archivo cargado -->
                    <div id="info-archivo" class="file-info-bar" style="display: none;">
                        <span class="file-info-name" id="nombre-archivo">documento.pdf</span>
                        <span class="file-info-pages"><span id="num-paginas">0</span> paginas</span>
                    </div>

                    <!-- Vista previa -->
                    <div id="seccion-preview" class="preview-section" style="display: none;">
                        <div class="preview-header">
                            <h3>Vista Previa (primera pagina)</h3>
                        </div>
                        <div id="preview-container" class="preview-container">
                            <p class="preview-placeholder">Cargando vista previa...</p>
                        </div>
                    </div>

                    <!-- Mensajes de estado -->
                    <div id="mensaje-estado" class="status-message" style="display: none;"></div>
                </section>

                <!-- Panel de opciones -->
                <aside id="panel-opciones" class="options-panel" style="display: none;">
                    <h3 style="margin-bottom: 20px;">Opciones de Conversion</h3>

                    <!-- Modo de conversion -->
                    <div class="option-section">
                        <h4>Modo de conversion</h4>
                        <div class="mode-selector">
                            <div class="mode-option">
                                <input type="radio" name="modo" id="modo-pagina" value="pagina" checked>
                                <label for="modo-pagina">
                                    <strong>Pagina completa</strong>
                                    <span>Convierte cada pagina a una imagen PNG</span>
                                </label>
                            </div>
                            <div class="mode-option">
                                <input type="radio" name="modo" id="modo-extraer" value="extraer">
                                <label for="modo-extraer">
                                    <strong>Extraer imagenes</strong>
                                    <span>Extrae solo las imagenes incrustadas del PDF</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Selector de DPI (solo para modo pagina) -->
                    <div class="option-section" id="seccion-dpi">
                        <h4>Calidad (DPI)</h4>
                        <div class="dpi-selector">
                            <div class="dpi-option">
                                <input type="radio" name="dpi" id="dpi-72" value="72">
                                <label for="dpi-72">72<span>Baja</span></label>
                            </div>
                            <div class="dpi-option">
                                <input type="radio" name="dpi" id="dpi-150" value="150" checked>
                                <label for="dpi-150">150<span>Media</span></label>
                            </div>
                            <div class="dpi-option">
                                <input type="radio" name="dpi" id="dpi-300" value="300">
                                <label for="dpi-300">300<span>Alta</span></label>
                            </div>
                            <div class="dpi-option">
                                <input type="radio" name="dpi" id="dpi-600" value="600">
                                <label for="dpi-600">600<span>Muy Alta</span></label>
                            </div>
                        </div>
                    </div>

                    <!-- Selector de paginas (solo para modo pagina) -->
                    <div class="option-section" id="seccion-paginas">
                        <h4>Paginas</h4>
                        <div class="pages-selector">
                            <div class="page-option">
                                <input type="radio" name="paginas-tipo" id="paginas-todas" value="all" checked>
                                <label for="paginas-todas">Todas las paginas</label>
                            </div>

                            <div class="page-option">
                                <input type="radio" name="paginas-tipo" id="paginas-rango" value="range">
                                <label for="paginas-rango">Rango de paginas</label>
                            </div>
                            <div class="page-range-inputs" id="rango-inputs" style="display: none;">
                                <span>Desde</span>
                                <input type="number" id="pagina-desde" min="1" value="1">
                                <span>hasta</span>
                                <input type="number" id="pagina-hasta" min="1" value="1">
                            </div>

                            <div class="page-option">
                                <input type="radio" name="paginas-tipo" id="paginas-especificas" value="specific">
                                <label for="paginas-especificas">Paginas especificas</label>
                            </div>
                            <div class="page-specific-input" id="especificas-input" style="display: none;">
                                <input type="text" id="paginas-lista" placeholder="1, 3, 5-10, 15">
                                <small>Separa con comas. Usa guion para rangos.</small>
                            </div>
                        </div>
                    </div>

                    <!-- Estimacion de tamano (modo pagina) -->
                    <div class="size-estimate" id="size-estimate">
                        <div class="size-estimate-row">
                            <span class="size-estimate-label">Paginas a convertir:</span>
                            <span class="size-estimate-value" id="est-paginas">-</span>
                        </div>
                        <div class="size-estimate-row">
                            <span class="size-estimate-label">Tamano estimado:</span>
                            <span class="size-estimate-value" id="est-tamano">-</span>
                        </div>
                    </div>

                    <!-- Info de imagenes (modo extraer) -->
                    <div class="size-estimate" id="info-imagenes" style="display: none;">
                        <div class="size-estimate-row">
                            <span class="size-estimate-label">Imagenes encontradas:</span>
                            <span class="size-estimate-value" id="est-num-imagenes">Analizando...</span>
                        </div>
                    </div>

                    <!-- Botones de accion -->
                    <div class="action-buttons" style="margin-top: 25px;">
                        <button id="btn-ejecutar" class="btn btn-primary" disabled>
                            Convertir a PNG
                        </button>
                    </div>

                    <!-- Progreso de procesamiento -->
                    <div id="progreso-proceso" class="progress-large" style="display: none; margin-top: 15px;">
                        <div class="progress-bar-large">
                            <div class="progress-fill" id="barra-proceso"></div>
                        </div>
                        <div class="progress-info">
                            <span id="texto-proceso">Procesando...</span>
                            <span id="porcentaje-proceso">0%</span>
                        </div>
                    </div>
                </aside>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p><strong>PDF-Export & Import</strong> - Herramientas de conversion PDF para la Soberanía Digital Empresarial</p>
            <p class="footer-info"><a href="/">Volver al inicio</a></p>

            <div class="footer-legal" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--color-border); font-size: 0.85rem; color: var(--color-text-light); text-align: left; max-width: 900px; margin-left: auto; margin-right: auto;">
                <h4 style="font-size: 0.95rem; margin-bottom: 10px; color: var(--color-text);">Aviso de uso y alcance</h4>
                <p style="margin-bottom: 10px;">Esta aplicación y su API están destinadas a uso privado.
                No se implementan claves de acceso a nivel de aplicación con el objetivo de mantener transparencia total sobre su funcionamiento y fomentar la conciencia respecto del tratamiento de documentos y datos compartidos.</p>

                <p style="margin-bottom: 10px;">Se recomienda su despliegue dentro de una red local (LAN), preferentemente en una zona desmilitarizada (DMZ).
                En caso de habilitar acceso externo, se sugiere hacerlo mediante un proxy inverso con mecanismos de autenticación, quedando dicha configuración bajo el criterio y responsabilidad del usuario.</p>

                <p style="margin-bottom: 10px;">Este proyecto se presenta como un prototipo funcional, orientado a mejorar la eficiencia operativa y promover la soberanía digital sobre los recursos informáticos utilizados para el procesamiento de documentos.</p>

                <p>El código y la aplicación se distribuyen bajo una licencia de uso público y amplio, permitiendo su utilización, modificación y adaptación conforme a dicho marco.</p>
            </div>
        </footer>
    </div>

    <script src="/config.js"></script>
    <script src="/static/js/common.js"></script>
    <script src="/static/js/pdf-to-png.js"></script>
</body>
</html>
